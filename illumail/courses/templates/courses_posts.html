{% extends 'base.html' %}

{% block content %}
<div class="container">
    {% if request.user.is_authenticated %}
        {% if is_followed %}
            <a class="btn btn-secondary" href="{% url 'leave_the_course' course.id %}">Покинуть</a>
        {% elif request.user == course.author %}

        {% else %}
            <a class="btn btn-secondary" href="{% url 'join_the_course' course.id %}">Вступить</a>
        {% endif %}
    {% else %}
        <h5><i>Авторизуйтесь, чтобы вступить</i></h5>
    {% endif %}

    {% if request.user == course.author %}
    <a class="btn btn-secondary" href="{% url 'update_course' course.id %}">Изменить курс</a>
    <a class="btn btn-secondary" href="{% url 'delete_course' course.id %}">Удалить курс</a>
    <a class="btn btn-secondary" href="{% url 'create_post' course.id %}">Добавить задание</a>
    {% endif %}
    <br><br>
    <h5>О курсе: {{ course.about_the_course|linebreaks }}</h5>


    {% for p in posts %}
    <div class="card">
        <div class="card-body">
        <h3>{{ p.title }}</h3>
        <h6>Дата создания: {{ p.time_created }} |
        Дата изменения: {{ p.time_updated }}</h6>
        </div>
        <a class="btn btn-secondary" href="{{ p.get_absolute_url }}">Подробнее</a>
    </div>
    <br>
    {% endfor %}

    <hr>
    <h3 align="center">Комментарии: {{ count_comments }}</h3>

    <form method="post" autocomplete="off">
        {% csrf_token %}
        {{ form.as_p }}
        <button class="btn btn-secondary">Добавить</button>
    </form>
    <br>

    {% for c in comments %}
    <div class="card">
        <div class="card-body">
            <h5>
                <img src="{{ c.author.photo.url }}" alt="" width="40" height="40">
                <a class="btn btn-outline-secondary" href="{% url 'another_user' c.author.pk %}">{{ c.author }}</a>
            </h5>
            <h5>{{ c.comment_text }}</h5>
            <h5>{{ c.time_created }}</h5>
        </div>
    </div>
    <br>
    {% endfor %}<br><br>
</div>
{% endblock %}